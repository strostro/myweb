<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Machine Learning Models for Image Recognition" /><meta property="og:locale" content="en" /><meta name="description" content="Three models (ANN, OpenCV and CNN) were trained to provide classification predictions for 19 specified celebrities. TensorFlow and scikit-learn for model training and evaluation." /><meta property="og:description" content="Three models (ANN, OpenCV and CNN) were trained to provide classification predictions for 19 specified celebrities. TensorFlow and scikit-learn for model training and evaluation." /><link rel="canonical" href="https://playwithdata.xyz/posts/machine-learning-image-recognition/" /><meta property="og:url" content="https://playwithdata.xyz/posts/machine-learning-image-recognition/" /><meta property="og:site_name" content="Robin" /><meta property="og:image" content="https://playwithdata.xyz/assets/img/celebrity_cover.jpeg" /><meta property="og:image:alt" content="image recognition for 19 celebrities" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-07T11:33:00+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://playwithdata.xyz/assets/img/celebrity_cover.jpeg" /><meta name="twitter:image:alt" content="image recognition for 19 celebrities" /><meta property="twitter:title" content="Machine Learning Models for Image Recognition" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-07T20:01:40+08:00","datePublished":"2025-04-07T11:33:00+08:00","description":"Three models (ANN, OpenCV and CNN) were trained to provide classification predictions for 19 specified celebrities. TensorFlow and scikit-learn for model training and evaluation.","headline":"Machine Learning Models for Image Recognition","image":{"alt":"image recognition for 19 celebrities","url":"https://playwithdata.xyz/assets/img/celebrity_cover.jpeg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://playwithdata.xyz/posts/machine-learning-image-recognition/"},"url":"https://playwithdata.xyz/posts/machine-learning-image-recognition/"}</script><title>Machine Learning Models for Image Recognition | Robin</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Robin"><meta name="application-name" content="Robin"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script async src="/assets/js/data/mathjax.js"></script> <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script> window.MathJax = { tex: { inlineMath: [['\\(', '\\)']], displayMath: [['$$', '$$']] } }; </script> <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar2.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Robin</a><p class="site-subtitle fst-italic mb-0">All about Data, Analytics, Product, and EdTech</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/strostro" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="mailto:robin.yxie@gmail.com" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/yue-robin-xie-77377b2ba" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Machine Learning Models for Image Recognition</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>Machine Learning Models for Image Recognition</h1><p class="post-desc fw-light mb-4">Three models (ANN, OpenCV and CNN) were trained to provide classification predictions for 19 specified celebrities. TensorFlow and scikit-learn for model training and evaluation.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1743996780" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 7, 2025 </time> </span> <span> Updated <time data-ts="1749297700" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 8, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/img/celebrity_cover.jpeg" class="popup img-link preview-img shimmer"><img src="/assets/img/celebrity_cover.jpeg" alt="image recognition for 19 celebrities" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">image recognition for 19 celebrities</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/yue-robin-xie-77377b2ba">Robin Xie</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4371 words" > <em>24 min</em> read</span></div></div></div></header><div class="content"><p><strong>Executive summary</strong></p><p>This study aimed to achieve classification predictions for 19 specified celebrities using input image data.</p><p>The dataset used in this study contains 3334 celebrity image entries, each containing 10000 feature values. The initial data preprocessing stage involved reshaping row data into NumPy arrays of shape (100,100, 1) for single-channel grayscale images or (100, 100, 3) for RGB images. This preprocessed data was then fed into various training models. In addition, the labels in the dataset were encoded to facilitate the machine-learning process.</p><p>The dataset was divided into a training set (70%), a validation set (20%) and a test set (10%). Three models were trained during the study: ANN, OpenCV and CNN. The key performance metrics considered include precision, recall, F1 score and accuracy. The performance of each model was further analyzed through a confusion matrix to check for misclassification.</p><p>The CNN model demonstrated the best overall performance, with 81% precision, 78% recall, 78% F1 score, and 78% accuracy. Compared to the other models in the test, CNN is clearly more effective for image recognition tasks.</p><p>This study used Python, which was selected for its extensive and powerful libraries. These include NumPy for data manipulation, OpenCV for image processing, and various machine learning libraries such as TensorFlow and scikit-learn for model training and evaluation.</p><p><strong>1.Introduction</strong></p><p>This project aims to perform celebrity classification predictions using provided image data. The dataset comprises 19 predefined celebrity categories, and the objective is to classify inputs into these categories. Fundamentally, this research focuses on facial feature extraction and recognition classification, a field with significant implications across various domains.</p><p>The ability to accurately classify individuals in images has a wide range of applications, from security systems and personal identity verification to digital entertainment. By advancing our understanding and capabilities in facial recognition, we can develop more sophisticated and reliable systems that can be deployed in real-world scenarios.</p><p>Facial recognition techniques have evolved significantly over the years. Initially, systems such as Eigenfaces, developed in the 1990s, used linear algebra and principal component analysis to extract facial features. Over time, more advanced methods such as Fisherfaces and local binary patterns have been developed to increase the system's robustness. These methods recognize faces more efficiently under a variety of conditions.</p><p>The advent of deep learning has completely revolutionized the classification, identification, and facial recognition fields. Convolutional neural network (CNN) is a type of deep neural network that is particularly well-suited to image processing tasks. In contrast to traditional algorithms, which require manual feature extraction, CNN learns patterns directly from image pixels. Each layer of the network learns to recognize increasingly complex features.</p><p>Artificial neural networks (ANN) represent another foundational technology in facial recognition. While less specialized than CNN in dealing with spatial hierarchies, ANN is also crucial for tasks that require modelling complex non-linear relationships. As a result, it typically requires manual feature engineering to identify relevant facial features prior to training, which makes them less efficient than CNN in processing raw image data.</p><p>OpenCV, which stands for Open-Source Computer Vision, offers a comprehensive suite of tools for facial recognition. It includes methods such as Haar Cascades(Kaur &amp; Mirza, 2021) and Histogram of Oriented Gradients (HOG), which were previously widely used before the advent of deep learning. </p><p>This project will investigate the performance of CNN, ANN, and OpenCV in face recognition classification tasks. By in-depth investigation of these methods, we aim to accurately classify input information into the predefined 19 celebrity categories and uncover some insights into image recognition classification algorithms.</p><p><strong>2.Materials and Methodologies</strong></p><p>2.1 Materials</p><p>2.1.1 Dataset Description</p><p>2.1.1.1 Image files</p><p>The image files comprise 19 folders, each representing a different celebrity. Each folder contains approximately 200 or more facial images. The images include a variety of angles and expressions, with some individuals in the images wearing glasses or make-up, and some in black and white. The image size is not standardized, ranging from 100 to 500 pixels in width or length. </p><p>The Table1 below provides an overview of information about the image files.</p><p>Table 1: Image statistics</p><div class="table-wrapper"><table><thead><tr><th>Folder Name<th>Image Count<th>Min Resolution<th>Max Resolution<tbody><tr><td>Alexandra Daddario<td>215<td>95×108<td>564×668<tr><td>Amber Heard<td>208<td>102×105<td>550×668<tr><td>Andy Samberg<td>186<td>95×108<td>550×658<tr><td>Anne Hathaway<td>193<td>102×108<td>527×558<tr><td>Chris Hemsworth<td>149<td>102×108<td>564×668<tr><td>Chris Pratt<td>166<td>100×108<td>564×671<tr><td>Dwayne Johnson<td>131<td>102×108<td>564×668<tr><td>Emma Stone<td>129<td>102×108<td>527×558<tr><td>Emma Watson<td>201<td>101×128<td>527×558<tr><td>Henry Cavil<td>185<td>102×108<td>564×668<tr><td>Hugh Jackman<td>169<td>99×108<td>527×558<tr><td>Jason Momoa<td>174<td>102×108<td>564×802<tr><td>Margot Robbie<td>211<td>102×108<td>564×802<tr><td>Robert Downey Jr<td>223<td>93×108<td>558×668<tr><td>Scarlett Johansson<td>191<td>102×108<td>564×668<tr><td>Taylor Swift<td>121<td>102×108<td>489×547<tr><td>Tom Holland<td>179<td>99×108<td>527×558<tr><td>Zendaya<td>128<td>102×108<td>489×554<tr><td>Zoe Saldana<td>176<td>102×105<td>527×554</table></div><p>2.1.1.2 Image data</p><p>The original dataset also contains image data in six spreadsheets, divided into two main categories: labelled and unlabelled datasets. Each category contains three image resolutions: 20*20, 50*50, and 100*100.</p><p>Table 2 below provides an overview of the image dataset.</p><p>Table 2: Image data statistics</p><div class="table-wrapper"><table><thead><tr><th>Type<th>File Name<th>Number of Images<th>Features per Image<tbody><tr><td>labelled<td>training_celeb20x20<td>3335<td>400<tr><td> <td>training_celeb50x50<td>3335<td>2500<tr><td> <td>training_celeb100x100<td>3335<td>10000<tr><td>unlabelled<td>unlabelledtest_celeb20x20<td>3335<td>400<tr><td> <td>unlabelledtest_celeb50x50<td>3335<td>2500<tr><td> <td>unlabelledtest_celeb100x100<td>3335<td>10000</table></div><p>2.1.1.3 Selected dataset for analysis</p><p>In this study, we trained the model on labelled datasets, initially experimenting with image resolutions of 20x20, 50x50 and 100x100 to test the models. Finally, we decided to train three different models using the 100x100 resolution. We selected this resolution because it provides more detailed information than 20x20 and 50x50, which is crucial for the models to learn more complex features.</p><p>Specifically, we selected the following datasets for analysis:</p><ul><li><p>Labelled 100x100 dataset: Used to train the model.</p><li><p>Unlabelled 100x100 dataset: Used to test the final results after the final deployment of the model.</p></ul><ol><li>Variable Description</ol><p>The 100*100 labelled data set comprises two types of variables. The first column, 'celeb', represents the label, indicating the celebrity's name corresponding to each row of data. The data is of a string data type. The columns from the 2nd to 10001st represent the features of each image, with a float data type ranging from -1 to 1. The column names range from c1r1 (representing the features in the first row of the first column of the image) to c100r100.</p><p>In the unlabelled 100x100 dataset, the columns from the 1st to the 10000th are all feature variables, and there is no 'celeb' variable.</p><p>2.2 Methodologies</p><p>2.2.1 Data Preprocessing</p><p>2.2.1.1 A data integrity check was conducted on the dataset to identify any missing values, outliers, or duplicates. One duplicate row was then deleted. The distribution of data for each celebrity was then analyzed.</p><p>2.2.1.2 Reshape data As shown in figure 1, each row of data extracted from the dataset is converted into two shapes. The first shape is 100x100x1, representing a single-channel grayscale image used in ANN and OpenCV models. The second shape is 100x100x3, representing an RGB image used in CNN models. This format is ideal for deep learning models, especially convolutional neural networks, as it allows them to handle images with color information and complex features. The data reshaping is to meet the input requirements of different models, thereby enabling them to process and analyze the image data more effectively.</p><p>Figure 1: Data reshaping process</p><p><a href="/assets/img/ml_img/media/image1.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image1.png" alt="" loading="lazy"></a></p><p>2.2.1.3 Mapping data</p><p>During the model deployment and testing process, the unlabeled dataset is mapped into actual image formats. The predicted name results from the model are then displayed directly above the images. This process helps visually verify the model's predictions.</p><p>Figure 2 shows that the row data is initially reshaped into a 100x100 NumPy array, which is then converted into an image.</p><p>Figure 2: Data mapping process</p><p><a href="/assets/img/ml_img/media/image2.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image2.png" alt="" loading="lazy"></a></p><p>2.2.1.4 Encoding</p><p>The original labels in the dataset are of the string type and must be converted into formats suitable for machine learning models. </p><p>We utilize the Sparse label encoding method. In this method, category labels are represented directly as integers. This approach is highly effective for handling large datasets.</p><p>2.2.2 Data Split</p><p>The 100 x 100 unlabelled dataset was divided into the following proportions:</p><p>(1) Training set (70%): used for the model training process and contains most data to ensure the model has sufficient learning information.</p><p>(2) Validation set (20%): used for performance validation during the model training process to avoid overfitting.</p><p>(3) Test set (10%): used to evaluate the final performance of the model after model training is complete.</p><p>2.2.3 Algorithm Description</p><p>2.2.3.1 Artificial Neural Network (ANN)</p><p>Artificial Neural Network (ANN) is a computing system. It consists of interconnected units or nodes that simulate the human brain's ability to recognize complex patterns and relationships in data. They are therefore often used for classification tasks.</p><p>Figure 3: ANN Model Architecture</p><p><a href="/assets/img/ml_img/media/image3.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image3.png" alt="A white rectangular object with black text Description automatically generated" loading="lazy"></a></p><p>Figure 3 illustrates the architecture of the ANN employed in this project:</p><p>The input layer: It receives the reshaped image data and prepares it for processing.</p><p>The Flatten Layer: This process transforms the multi-dimensional image data into a one-dimensional array, enabling the extraction of features more efficiently.</p><p>Dense layers:</p><p>The initial dense layer comprises 3,000 neurons, which are essential for the learning of high-level features.</p><p>The second dense layer of 1,000 neurons serves to refine these features further.</p><p>The output layer: The trained features are then used to classify images by celebrity, resulting in the final predictive output.</p><p>2.2.3.2 Open-source computer vision library (OpenCV)</p><p>OpenCV is an open-source computer vision and machine learning software library. It offers a comprehensive range of image processing and recognition algorithms, which are well-suited to complex facial recognition tasks.</p><p>This study uses OpenCV's Local Binary Patterns Histograms (LBPH) algorithm for face recognition tasks. LBPH is a face-recognition algorithm used in image processing to identify faces by analyzing simple patterns within the image.</p><p>In this project, the LBPH face recognizer is first initialized. The recognizer is then trained using a training dataset of labelled face images. This phase involves learning the distinctive features of each face that are essential for distinguishing between different individuals.</p><p>2.2.3.3 Convolutional Neural Networks（CNN）</p><p>CNN is a deep learning method. By employing convolutional, pooling and fully connected layers, CNN can automatically learn and extract meaningful features from images. It is a highly effective tool for a range of image-related tasks, including classification, object detection and segmentation.</p><p>Figure 4: ANN Model Architecture and Optimizer Process</p><p><a href="/assets/img/ml_img/media/image4.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image4.png" alt="" loading="lazy"></a></p><p>After a series of adjustments and optimizations, we selected a specific CNN model, as shown in Figure 4. This model's design is centered around two key components: the model architecture and model optimization.</p><p>(1) Model architecture </p><p>The model architecture was developed using MobileNetV2 as the foundational structure, incorporating additional custom layers to enhance performance.</p><p>a) MobileNetV2</p><p>MobileNetV2 is a convolutional neural network architecture designed for mobile devices. It focuses on efficiency and effectiveness in feature extraction.</p><p>In this project, MobileNetV2 was selected as the feature extractor. The input shape was adjusted to three channels:100x100x3. This adjustment aims to leverage MobileNetV2's feature extraction capabilities to their full potential.</p><p>Furthermore, freezing layers represents a crucial strategy in the model. The initial 40 layers of the model are frozen to ensure the preservation of the base features learned by MobileNetV2. This operation guarantees that these base features will not be altered by the training process of the new dataset, enhancing the stability and training efficiency of the model.</p><p>b) Adding custom layers</p><p>Following the implementation of MobileNetV2, several custom layers were added to enhance the model's ability to handle specific tasks.</p><p>GlobalAveragePooling2D: Used to reduce the number of parameters, simplify the model and reduce the risk of overfitting.</p><p>Dense layer: Contains 128 neurons activated using ReLU, which introduces non-linearity to help the model learn complex patterns.</p><p>Dropout Layer: 50% of neurons are randomly discarded during training to prevent overfitting.</p><p>Output layer: Fully connected layer using a softmax activation function, which transforms the input into a probability distribution and calculates the probability of each celebrity category.</p><p>(2) Model Training Optimization</p><p>In the compiling and fitting session of the CNN model, we used some optimization strategies to improve the performance of the model:</p><p>a) Adam Optimizer: An iterative optimization algorithm designed for training deep learning models. It utilizes an adaptive learning rate mechanism to converge to optimal solutions efficiently.</p><p>b) Data Augmentation: The method artificially expands the training set by creating modified versions of the images in it. Our study augmented the facial dataset with various transformations, including rotation, scaling, stretching, and brightness adjustment. These modifications help to simulate different viewing conditions, providing a more diverse training dataset.</p><p>c) Early stopping: Monitors the model's performance on the validation set and stops training if the performance does not improve after several epochs. This prevents overfitting of the training data and saves time and computational resources.</p><p>2.2.4 Evaluation metrics</p><p>2.2.4.1 Precision</p><p>Precision measures the proportion of correct predictions for a given class out of all predictions made. High image classification precision means fewer non-target objects are mistakenly identified as the target class.</p><p>2.2.4.2 Recall</p><p>Recall measures the proportion of actual positives identified correctly by the model out of all actual positives. In this project, a higher recall indicates that the model effectively captures a larger portion of actual celebrity images.</p><p>2.2.4.3 F1 score</p><p>The F1 score provides a balanced measure of the model's accuracy and recall. In this project, a high F1 score indicates robust and balanced performance in identifying celebrity images precisely and comprehensively.</p><p>The formula for the F1 score is: $F1 = 2*(\frac{Precision \times Recall}{Precision + Recall}$)</p><p>2.2.4.4 Accuracy rate</p><p>Accuracy is the ratio of correct predictions to the total number of predictions made. In a project identifying 19 celebrities, a high accuracy rate means that the model effectively distinguishes and recognizes different celebrity faces.</p><p>2.2.4.5 Confusion matrix</p><p>The confusion matrix is a table that shows the number of correct and incorrect predictions by each category.</p><p>To evaluate our model's performance across the 19 celebrity categories, we used a confusion matrix to represent the accuracy of the predictions. The diagonal items of the matrix represent the correct classification of each category, while the off-diagonal items indicate prediction errors, indicating the number of times the model incorrectly labelled a category as another.</p><p>2.2.4.6 Training and validation accuracy curves</p><p>The training and validation accuracy curves demonstrate the model's effectiveness in predicting the target variable on the training and validation datasets over the epochs. This comparison helps assess the model's performance and its ability to generalize to unseen data.</p><p><strong>3.Result</strong></p><p>3.1 Data Preprocessing</p><p>3.1.1 Data clean</p><p>Figure 5: Distribution of Data per Celebrity</p><p>Figure 5 illustrates the quantity of image data for each celebrity, demonstrating variations between them. Robert Downey Jr. and Alexandra Daddario have the most significant number of images, with approximately 220 images each. Conversely, Taylor Swift, Emma Stone, Zendaya, and Dwayne Johnson have the lowest data volumes, with approximately 120 images each. The discrepancy in data volume between the highest and lowest categories is almost twice as significant.</p><p>The discrepancy in the data volume may bias our model, which could affect its performance in categories with less data. This issue may indicate a challenge in model training.</p><p>3.1.2 Reshaping data</p><p>To meet the input requirements of the model, we reshaped each row of data in the table dataset to 100x100x1, meaning that each piece of image data was processed as a single-channel (greyscale) image of 100x100 pixels. After processing, we took the first data of each celebrity in the table data and did the image mapping to preview it. By visualizing the data matrix, we confirmed that the conversion was successful.</p><p>Figure 6: Preview of reshaping data after converting to image</p><p><a href="/assets/img/ml_img/media/image5.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image5.png" alt="" loading="lazy"></a></p><p>3.2 Model result</p><p>3.2.1 ANN</p><p>After training the ANN model, it was tested on the test set, achieving a final accuracy of 29%.</p><p>3.2.1.1 Precision, recall, F1-score</p><p>Figure 6 illustrates the precision, recall, and F1-score for each celebrity category using the ANN model.</p><p>Figure 7: The precision, recall and F1-score of ANN model</p><p>The figure illustrates a considerable variation in recall and precision among celebrities. Taylor Swift has a higher recall rate than the average celebrity but a lower precision rate. This indicates that while the model can identify most images of Taylor Swift, it also incorrectly classifies other celebrities as her, resulting in a higher number of false positives. This may be due to the learning of over-generalized features for this category. These features lack sufficient distinction to differentiate accurately between individuals with similar appearances.</p><p>On the other hand, celebrities such as Amber Heard, Emma Stone, Anne Hathaway, Jason Momoa, and Tom Holland showed high precision but low recall, suggesting that the model was more conservative in predicting these categories conservatively, missing many true positives. This may mean that the model is too strict in identifying these categories.</p><p>Margot Robbie has the highest F1 score, indicating that the model achieves a good balance between precision and recall for this celebrity.</p><p>3.2.1.2 Confusion matrix</p><p>Figure 8: The confusion matrix of ANN model</p><p><a href="/assets/img/ml_img/media/image6.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image6.png" alt="" loading="lazy"></a></p><p>Further analysis of the confusion matrix revealed that many of the celebrity images were misidentified as Taylor Swift and Alexandra Daddario. This suggests that the features learnt by the model from these two individuals may be too dominant or generic. This causes the model to be prone to misclassification when confronted with other celebrities with similar features.</p><p>On the diagonal, Emma Stone had the lowest value of 1, meaning that the model had great difficulty correctly recognizing images of her. This low accuracy suggests that the model may not be capturing the unique features needed to distinguish her accurately or that there is insufficient training data for this category.</p><p>3.2.1.3 Training, validation, and test accuracy</p><p>Figure 9: Training, Validation, and Test Accuracy (ANN)</p><p><a href="/assets/img/ml_img/media/image7.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image7.png" alt="A graph with a line and a line Description automatically generated" loading="lazy"></a></p><p>As illustrated in Figure 9, the significant gap between the training and validation accuracy levels indicates overfitting. While the model performs well on the training data, it struggles to generalize to the validation data.</p><p>Furthermore, the relatively low and fluctuating validation accuracy and the stable but low test accuracy suggest that the model is not generalizing well to new data. </p><p>3.2.2 OpenCV</p><p>After testing the OpenCV model on a test set, it achieved a final accuracy of 43%.</p><p>3.2.2.1 Precision, recall, F1-score</p><p>Figure 10: The precision, recall and F1-score of OpenCV model</p><p>As can be seen from the figure 10, there is not a large difference between precision and recall for most celebrities, which suggests that the model performs relatively evenly across the different celebrity categories.</p><p>However, Chris Pratt precision is much larger than the recall, this suggests that the model is usually accurate when predicting as Chris Pratt but misses many true cases.</p><p>Looking at the F1 scores, there is not much variation in values across celebrities, with the highest being Emma Watson, Margot Robbie, and Robert Downey Jr, suggesting that the categories of these celebrities achieve a better balance between precision and recall.</p><p>3.2.2.2 Confusion matrix</p><p>Figure 11: The confusion matrix of OpenCV model</p><p><a href="/assets/img/ml_img/media/image8.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image8.png" alt="" loading="lazy"></a></p><p>Further analysis of the confusion matrix indicates that Alexandra Daddario, Robert Downey Jr. and Emma Watson have the highest values on the diagonal, suggesting that the model can recognize these celebrities with high accuracy. Conversely, Dwayne Johnson has the lowest value on the diagonal, indicating that the model has difficulty accurately recognizing him. This may be due to the model capturing fewer features or the training data being under-representative.</p><p>Tom Hollander and Emma Stone were frequently misidentified as other celebrities in the non-diagonal region, with a relatively even distribution across categories. This indicates that the model cannot distinguish between their features and those of other celebrities. This may be due to the model failing to capture their distinctive features effectively.</p><p>OpenCV shows lower false recognition values in the confusion matrix's non-diagonal region than in the ANN model. This suggests that the OpenCV model may have better feature discrimination ability when dealing with the face recognition task. In contrast, ANN may have some limitations in feature extraction and classification of categories, resulting in higher false recognition rates between certain celebrities.</p><p>3.2.2.3 Training, validation, and test accuracy</p><p>In OpenCV, the LBPH FaceRecognizer does not involve an iterative training process over multiple epochs. As a result, it is impossible to record training and validation accuracy for each epoch. Consequently, there is no concept of plotting training, validation, and test accuracy graphs for the OpenCV model.</p><p>3.2.3 CNN</p><p>3.2.3.1 Precision, recall, F1-score</p><p>The third method is based on CNN. The initial CNN model achieved an accuracy of 47%, higher than the ANN and OpenCV-based models. Building on this initial success, we optimized the CNN model further. The accuracy of our CNN model improved significantly, reaching approximately 78%.</p><p>Figure 12: The precision, recall and F1-score of CNN model</p><p>The figure 12 illustrates that the differences between precision and recall are relatively insignificant for most celebrities. In summary, all three metrics – precision, recall and F1-score – demonstrate superior performance compared to the ANN and OpenCV models.</p><p>These results also show that Emma Stone's recall and precision are below average, with recall being particularly poor. This indicates that the model has significant difficulty correctly recognizing images of Emma Stone. </p><p>3.2.3.2 Confusion matrix</p><p>Figure 13: The confusion matrix of CNN model</p><p><a href="/assets/img/ml_img/media/image9.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image9.png" alt="" loading="lazy"></a></p><p>As shown in Figure 13, the high diagonal values indicate that most of the predictions are correct. It is worth noting that Emma Stone has a significantly lower diagonal value, which is consistent with the observation in Figure 11. In addition, we find a high misclassification between Emma Stone and Emma Watson, which may indicate that the model is having difficulty distinguishing between these two celebrities. This situation may be due to the failure of the model to capture the key features that distinguish these two celebrities.</p><p>3.2.3.3 Training, validation, and test accuracy</p><p>Figure 14: Training, Validation, and Test Accuracy (CNN)</p><p><a href="/assets/img/ml_img/media/image10.png" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image10.png" alt="A graph showing the growth of a number of people Description automatically generated" loading="lazy"></a></p><p>Figure 14 demonstrates the excellent performance of the CNN model on the training, validation, and test sets. The gradual increase in training and validation accuracy shows that the model is constantly learning and optimizing. The test accuracy is close to the validation accuracy. It reaches a value of almost 80%, indicating that the model has good generalization ability and can maintain high accuracy on new data.</p><p>3.3 Models Performance Comparison</p><p>Figure 15: Model comparison</p><p>As shown in figure 15, the ANN model demonstrated precision and recall at 0.33 and 0.29, respectively, with an F1 score and an accuracy of approximately 0.28. indicating struggles with false positives and negatives. The OpenCV-based model shows improvement, with all metrics around 0.43, suggesting fewer errors and a more balanced performance.</p><p>The CNN model significantly outperformed both the ANN and OpenCV models, with precision, recall, F1-score, and accuracy at levels of 0.81, 0.78, 0.78, and 0.78, respectively. </p><p>Overall, the CNN model performed excellent on all metrics compared to the ANN and OpenCV models. It obtained the highest precision, recall, F1 score and accuracy scores, making it the most efficient and reliable model for this image recognition task.</p><p>3.4 Model Implementation</p><p>Following the evaluation of three models, the CNN model was selected as the most suitable implementation.</p><p>From the unlabelled dataset, we select the top 50 data for the prediction test. First, these 50 data are converted into images, and then the trained model is used for celebrity face recognition. The predicted name is displayed on top of the image. In this way, we have visualized the prediction results.</p><p>Figure 16: Convert data results to images for preview after prediction on unlabelled dataset</p><p><a href="/assets/img/ml_img/media/image11.jpeg" class="popup img-link shimmer"><img src="/assets/img/ml_img/media/image11.jpeg" alt="A collage of a group of people Description automatically generated" loading="lazy"></a></p><p>From the visualization of the results, we can see that out of these 50 characters, 10 people were incorrectly predicted. The accuracy of this prediction is therefore 80%. Additionally, we verified the predicted labels for the first 190 individuals in the unlabeled dataset, resulting in an accuracy of 77.4%.</p><p>In conclusion, the model demonstrated an approximate accuracy of 77% in practical applications. This indicates that the model has a high accuracy in practical applications.</p><p><strong>4.Discussion</strong></p><p>This study demonstrates the outstanding performance of CNN in image recognition tasks and reflects some valuable insights gained from different modelling approaches.</p><p>Firstly, this study has found that CNN perform best in facial recognition tasks. This advantage is primarily due to their strength in feature extraction, a crucial aspect of image classification tasks. Structurally, CNN contain convolutional layers that efficiently capture spatial hierarchies in images.</p><p>Secondly, from the performance of the three models, we found that Taylor Swift, Emma Stone, Zendaya and Dwayne Johnson performed worse. This could be because these celebrities had less data in the training set. The limited data makes it difficult for the model to learn their unique features efficiently, resulting in lower precision, recall and overall accuracy for these categories.</p><p>Therefore, it is concluded that the amount of training data plays a crucial role in the model's ability to classify images accurately.</p><p>Thirdly, the final CNN model's performance enhancements resulted from several optimizations. We employed data augmentation techniques to artificially increase the diversity of the training data, which helped the model generalize better. Additionally, we used freezing layers to retain the valuable low-level features learned from the MobileNetV2, which served as a feature extractor. These steps collectively led to a significant improvement in the CNN model's performance.</p><p>Finally, while CNN has demonstrated impressive performance in the face recognition task, we are optimistic about the potential for further enhancements.</p><p>To begin with, we can include a procedure to locate the face in the image before recognizing it. Once a face is detected, the system can automatically crop out the face region from the entire picture and analyze only this part. This step allows subsequent recognition algorithms to focus on the face region, thus significantly reducing the interference of background noise and improving recognition accuracy. </p><p>Moreover, multiple different models can be integrated for learning, which can improve the system's robustness and accuracy. For example, the prediction results of multiple CNN models based on different architectures can be integrated to improve the overall recognition effect by voting or averaging. </p><p>Additionally, the diversity and scale of datasets can be expanded. For instance, using web crawlers to automatically collect more images of celebrities from the Internet can result in more abundant training data, which can assist the model in learning and generalizing more effectively. </p><p>Furthermore, by extending the application scenarios, we can move from binary classification to multi-classification tasks, identifying not only celebrities in images but also their specific activities or emotional states. This extension not only improves the system's utility but also enables it to be useful in a wider range of application scenarios.</p><p><strong>5.Conclusion</strong></p><p>This study aimed to achieve classification predictions for 19 specified celebrities based on input image data. We investigated three models, ANN, CNN, and OpenCV, respectively, and found that CNN performed best on all metrics. This result confirms the effectiveness of convolutional neural networks in face recognition tasks, especially when dealing with complex image data. </p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/machinelearning/">MachineLearning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine learning</a> <a href="/tags/data-mining/" class="post-tag no-text-decoration" >data mining</a> <a href="/tags/tensorflow/" class="post-tag no-text-decoration" >TensorFlow</a> <a href="/tags/scikit-learn/" class="post-tag no-text-decoration" >Scikit-Learn</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Machine%20Learning%20Models%20for%20Image%20Recognition%20-%20Robin&url=https%3A%2F%2Fplaywithdata.xyz%2Fposts%2Fmachine-learning-image-recognition%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Machine%20Learning%20Models%20for%20Image%20Recognition%20-%20Robin&u=https%3A%2F%2Fplaywithdata.xyz%2Fposts%2Fmachine-learning-image-recognition%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fplaywithdata.xyz%2Fposts%2Fmachine-learning-image-recognition%2F&text=Machine%20Learning%20Models%20for%20Image%20Recognition%20-%20Robin" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/WorkLifeBalanceIndicators_MultivariateAnalysis/">Multivariate Analysis of Work-Life Balance Indicators</a><li class="text-truncate lh-lg"> <a href="/posts/machine-learning-image-recognition/">Machine Learning Models for Image Recognition</a><li class="text-truncate lh-lg"> <a href="/posts/pd-wealth/">Psychological Distress and Net Worth: An Econometric Investigation</a><li class="text-truncate lh-lg"> <a href="/posts/price-and-promotion/">How Pricing and Promotions Drive Sales Growth</a><li class="text-truncate lh-lg"> <a href="/posts/Economic-Downturn/">Economic Downturn and Child Poverty in New Zealand</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/data-modelling/">data modelling</a> <a class="post-tag btn btn-outline-primary" href="/tags/marketing-analysis/">marketing analysis</a> <a class="post-tag btn btn-outline-primary" href="/tags/analytics-pipeline/">Analytics Pipeline</a> <a class="post-tag btn btn-outline-primary" href="/tags/data-analysis/">Data Analysis</a> <a class="post-tag btn btn-outline-primary" href="/tags/data-mining/">data mining</a> <a class="post-tag btn btn-outline-primary" href="/tags/dbt/">dbt</a> <a class="post-tag btn btn-outline-primary" href="/tags/econometric/">econometric</a> <a class="post-tag btn btn-outline-primary" href="/tags/education/">Education</a> <a class="post-tag btn btn-outline-primary" href="/tags/kafka/">Kafka</a> <a class="post-tag btn btn-outline-primary" href="/tags/machine-learning/">machine learning</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/WorkLifeBalanceIndicators_MultivariateAnalysis/" class="btn btn-outline-primary" aria-label="Older" ><p>Multivariate Analysis of Work-Life Balance Indicators</p></a> <a href="/posts/pd-wealth/" class="btn btn-outline-primary" aria-label="Newer" ><p>Psychological Distress and Net Worth: An Econometric Investigation</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://www.linkedin.com/in/yue-robin-xie-77377b2ba">Robin Xie</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/data-modelling/">data modelling</a> <a class="post-tag btn btn-outline-primary" href="/tags/marketing-analysis/">marketing analysis</a> <a class="post-tag btn btn-outline-primary" href="/tags/analytics-pipeline/">Analytics Pipeline</a> <a class="post-tag btn btn-outline-primary" href="/tags/data-analysis/">Data Analysis</a> <a class="post-tag btn btn-outline-primary" href="/tags/data-mining/">data mining</a> <a class="post-tag btn btn-outline-primary" href="/tags/dbt/">dbt</a> <a class="post-tag btn btn-outline-primary" href="/tags/econometric/">econometric</a> <a class="post-tag btn btn-outline-primary" href="/tags/education/">Education</a> <a class="post-tag btn btn-outline-primary" href="/tags/kafka/">Kafka</a> <a class="post-tag btn btn-outline-primary" href="/tags/machine-learning/">machine learning</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
